{"version":3,"file":"draggable-panel.umd.js","sources":["../src/components/draggablePanel/index.ts"],"sourcesContent":["import {\n    markRaw,\n    defineComponent,\n    PropType,\n    ref,\n    computed,\n    watch,\n    h,\n    onMounted,\n    onBeforeUnmount,\n}\n    from 'vue'\n\nimport {\n    ChartItem,\n    Position,\n    Style,\n} from '../../../types/draggable-panel'\nimport './index.sass'\n\nexport default markRaw(defineComponent({\n    name : 'draggable-panel',\n    props: {\n        width         : {\n            required: true,\n            type    : Number as PropType<number>,\n        },\n        height        : {\n            required: true,\n            type    : Number as PropType<number>,\n        },\n        data          : {\n            required: true,\n            type    : Array as PropType<ChartItem[]>,\n        },\n        chartMinWidth : {\n            required: false,\n            type    : Number as PropType<number>,\n            default : 100,\n        },\n        chartMinHeight: {\n            required: false,\n            type    : Number as PropType<number>,\n            default : 100,\n        },\n        padding       : {\n            required: false,\n            type    : Number as PropType<number>,\n            default : 32,\n        },\n        lock          : {\n            required: false,\n            type    : Boolean as PropType<boolean>,\n            default : false,\n        },\n        canvasStyle   : {\n            required: false,\n            type    : Object as PropType<Style>,\n            default : {},\n        },\n        chartStyle    : {\n            required: false,\n            type    : Object as PropType<Style>,\n            default : {},\n        },\n        scaleMin      : {\n            required: false,\n            type    : Number as PropType<number>,\n            default : 0.5,\n        },\n        scaleMax      : {\n            required: false,\n            type    : Number as PropType<number>,\n            default : 10,\n        },\n    },\n    emits: [\n        'canvas-scale',\n        'canvas-drop',\n    ],\n    setup (props, ctx) {\n        const container         = ref<HTMLElement | null>(null)\n        const canvas            = ref<HTMLElement | null>(null)\n        const canvasStatusMove  = ref<boolean>(false)\n        const pointerPressed    = ref<boolean>(false)\n        const outCanvasDragover = ref<boolean>(false)\n        const defaultScale      = ref<number>(1)\n        const scale             = ref<number>(1)\n        const defaultX          = ref<number>(0)\n        const defaultY          = ref<number>(0)\n        const canvasX           = ref<number>(0)\n        const canvasY           = ref<number>(0)\n        const resizeDirection   = ref<string>('')\n        const movingChart       = ref<ChartItem | null>(null)\n        const resizingChart     = ref<ChartItem | null>(null)\n        const diff              = ref<Position>({ x: 0, y: 0 })\n        const point             = ref<Position>({ x: 0, y: 0 })\n        const lastPointermove   = ref<Position>({ x: 0, y: 0 })\n        const chartPosition     = ref<Position>({ x: 0, y: 0 })\n\n        const canvasStyleComputed = computed(() => ({\n            ...props.canvasStyle,\n            ...{\n                'width'    : props.width + 'px',\n                'height'   : props.height + 'px',\n                'transform': [\n                    // translate3d better than translate\n                    `translate3d(${canvasX.value}px, ${canvasY.value}px, 0)`,\n                    `scale(${scale.value})`,\n                ].join(' '),\n            },\n        }))\n        const chartStyleComputed  = computed(() => {\n            return (chartItem: ChartItem, index: number) => {\n                const { width, height, x, y } = chartItem\n                return {\n                    ...props.chartStyle,\n                    ...{\n                        // translate better than translate3d\n                        // translate3d causes blurry content\n                        'width'    : width + 'px',\n                        'height'   : height + 'px',\n                        'transform': `translateX(${x}px) translateY(${y}px)`,\n                        'z-index'  : 100 + index,\n                    },\n                }\n            }\n        })\n\n        watch(scale, newScale => ctx.emit('canvas-scale', newScale))\n\n        /**\n         * Scale canvas by wheel\n         * @param event\n         */\n        const scaleByWheel = (event: WheelEvent) => {\n            const { ctrlKey, metaKey } = event\n\n            if (!ctrlKey && !metaKey) return\n\n            event.preventDefault()\n\n            if (props.lock) return\n\n            let ratio = 1 / (1 + event.deltaY * 0.001)\n            let zoom  = scale.value * ratio\n\n            if (zoom > props.scaleMax) {\n                ratio = props.scaleMax / scale.value\n                zoom  = props.scaleMax\n            }\n\n            if (zoom < props.scaleMin) {\n                ratio = props.scaleMin / scale.value\n                zoom  = props.scaleMin\n            }\n\n            scale.value = zoom\n\n            const origin = {\n                x: (ratio - 1) * props.width * 0.5,\n                y: (ratio - 1) * props.height * 0.5,\n            }\n\n            canvasX.value -= (ratio - 1) * (event.clientX - canvasX.value) - origin.x\n            canvasY.value -= (ratio - 1) * (event.clientY - canvasY.value) - origin.y\n        }\n\n        /**\n         * Scale canvas add\n         * @param event\n         */\n        const scaleAddByKeyboard = (event: KeyboardEvent) => {\n            event.preventDefault()\n\n            if (props.lock) return\n\n            let zoom = scale.value + 0.1\n\n            if (zoom > props.scaleMax) zoom = props.scaleMax\n\n            scale.value = zoom\n        }\n\n        /**\n         * Scale canvas sub\n         * @param event\n         */\n        const scaleSubByKeyboard = (event: KeyboardEvent) => {\n            event.preventDefault()\n\n            if (props.lock) return\n\n            let zoom = scale.value - 0.1\n\n            if (zoom < props.scaleMin) zoom = props.scaleMin\n\n            scale.value = zoom\n        }\n\n        /**\n         * Reset scale\n         */\n        const resetScale = () => {\n            if (props.lock) return\n\n            scale.value   = defaultScale.value\n            canvasX.value = defaultX.value\n            canvasY.value = defaultY.value\n        }\n\n        /**\n         * Real scale\n         */\n        const realScale = () => {\n            if (props.lock) return\n\n            const { offsetWidth, offsetHeight } = container.value\n\n            scale.value   = 1\n            canvasX.value = (offsetWidth - props.width) / 2\n            canvasY.value = (offsetHeight - props.height) / 2\n        }\n\n        /**\n         * Pointer down\n         * @param event\n         */\n        const pointerDown = (event: PointerEvent) => {\n            if (!canvasStatusMove.value || props.lock) return\n\n            pointerPressed.value = true\n\n            canvas.value.setPointerCapture(event.pointerId)\n\n            point.value           = { x: event.clientX, y: event.clientY }\n            lastPointermove.value = { x: event.clientX, y: event.clientY }\n        }\n\n        /**\n         * Pointer move\n         * @param event\n         */\n        const pointermove = (event: PointerEvent) => {\n            if (!pointerPressed.value) return\n\n            event.preventDefault()\n\n            const current = { x: event.clientX, y: event.clientY }\n\n            diff.value = {\n                x: current.x - lastPointermove.value.x,\n                y: current.y - lastPointermove.value.y,\n            }\n\n            lastPointermove.value = { x: current.x, y: current.y }\n            canvasX.value += diff.value.x\n            canvasY.value += diff.value.y\n        }\n\n        /**\n         * Pointer up\n         */\n        const pointerUp = () => {\n            pointerPressed.value = false\n        }\n\n        /**\n         * Pointer cancel\n         */\n        const pointerCancel = () => {\n            pointerPressed.value = false\n        }\n\n        /**\n         * Set chart position\n         * @param event\n         */\n        const setChartPosition = (event: MouseEvent) => {\n            chartPosition.value = {\n                x: event.clientX,\n                y: event.clientY,\n            }\n        }\n\n        /**\n         * Chart move/resize start\n         * @param event\n         * @param chart\n         */\n        const chartDragstart = (event: DragEvent, chart: ChartItem) => {\n            if (!event.dataTransfer) return\n\n            hideDragImage(event.dataTransfer)\n\n            movingChart.value = chart\n        }\n\n        /**\n         * Resize start\n         * @param event\n         * @param chart\n         * @param direction\n         */\n        const resizeStart = (event: DragEvent, chart: ChartItem, direction: string) => {\n            event.stopPropagation()\n\n            if (!event.dataTransfer) return\n\n            hideDragImage(event.dataTransfer)\n\n            resizingChart.value   = chart\n            resizeDirection.value = direction\n        }\n\n        /**\n         * Dragover over container (move/resize)\n         * @param event\n         */\n        const dragoverContainer = (event: DragEvent) => {\n            event.preventDefault()\n\n            const { clientX, clientY } = event\n            const offsetX              = (clientX - chartPosition.value.x) / scale.value\n            const offsetY              = (clientY - chartPosition.value.y) / scale.value\n\n            chartPosition.value = { x: clientX, y: clientY }\n\n            if (movingChart.value) {\n                const { width, height, x, y } = movingChart.value\n                const maxX                    = props.width - width\n                const maxY                    = props.height - height\n\n                let newX = x + offsetX\n                let newY = y + offsetY\n\n                if (newX < 0) newX = 0\n                if (newY < 0) newY = 0\n                if (newX > maxX) newX = maxX\n                if (newY > maxY) newY = maxY\n\n                movingChart.value.x = newX\n                movingChart.value.y = newY\n            }\n\n            if (resizingChart.value) {\n                const { width, height, x, y } = resizingChart.value\n                const chartMaxWidth           = props.width - x\n                const chartMaxHeight          = props.height - y\n                const direction               = resizeDirection.value\n\n                let newWidth  = width\n                let newHeight = height\n                let newX      = x\n                let newY      = y\n\n                const resizeWidth       = () => {\n                    newWidth += offsetX\n                    if (newWidth < props.chartMinWidth) newWidth = width\n                    if (newWidth > chartMaxWidth) newWidth = chartMaxWidth\n                }\n                const resizeHeight      = () => {\n                    newHeight += offsetY\n                    if (newHeight < props.chartMinHeight) newHeight = height\n                    if (newHeight > chartMaxHeight) newHeight = chartMaxHeight\n                }\n                const resizeWidthWithX  = () => {\n                    newX     = x + offsetX\n                    newWidth = width - offsetX\n\n                    if (newX < 0) {\n                        newX     = 0\n                        newWidth = width + x\n                    }\n\n                    if (newWidth < props.chartMinWidth) {\n                        newWidth = width\n                        newX     = x\n                    }\n                }\n                const resizeHeightWithY = () => {\n                    newY      = y + offsetY\n                    newHeight = height - offsetY\n\n                    if (newY < 0) {\n                        newY      = 0\n                        newHeight = height + y\n                    }\n\n                    if (newHeight < props.chartMinHeight) {\n                        newHeight = height\n                        newY      = y\n                    }\n                }\n\n                if (direction === 'a') {\n                    resizeWidthWithX()\n                    resizeHeightWithY()\n                }\n\n                if (direction === 'b') {\n                    resizeWidth()\n                    resizeHeightWithY()\n                }\n\n                if (direction === 'c') {\n                    resizeWidth()\n                    resizeHeight()\n                }\n\n                if (direction === 'd') {\n                    resizeWidthWithX()\n                    resizeHeight()\n                }\n\n                if (direction === 'i') resizeHeightWithY()\n                if (direction === 'j') resizeWidth()\n                if (direction === 'k') resizeHeight()\n                if (direction === 'l') resizeWidthWithX()\n\n                resizingChart.value.width  = newWidth\n                resizingChart.value.height = newHeight\n                resizingChart.value.x      = newX\n                resizingChart.value.y      = newY\n            }\n        }\n\n        /**\n         * Drop in canvas\n         * @param event\n         */\n        const dropInCanvas = (event: DragEvent) => {\n            if (movingChart.value || resizingChart.value) return\n\n            outCanvasDragover.value = false\n\n            ctx.emit('canvas-drop', event, {\n                x: event.offsetX,\n                y: event.offsetY,\n            })\n        }\n\n        /**\n         * Chart move/resize end\n         */\n        const chartDragend = () => {\n            container.value.focus()\n\n            movingChart.value   = null\n            resizingChart.value = null\n\n            document\n                .querySelectorAll('.draggable-panel canvas[data-action=\"empty\"]')\n                .forEach(item => item.remove())\n        }\n\n        /**\n         * Drag in from outside the canvas\n         */\n        const dragenterCanvas = () => {\n            if (movingChart.value || resizingChart.value) return\n\n            outCanvasDragover.value = true\n        }\n\n        /**\n         * Drag in from outside the canvas cancel\n         */\n        const dragleaveCanvas = () => {\n            outCanvasDragover.value = false\n        }\n\n        /**\n         * Hide dragImage\n         * @param dataTransfer\n         */\n        function hideDragImage (dataTransfer: DataTransfer) {\n            const empty = document.createElement('canvas')\n\n            empty.setAttribute('data-action', 'empty')\n\n            container.value.appendChild(empty)\n\n            dataTransfer.setDragImage(empty, 0, 0)\n            dataTransfer.dropEffect    = 'move'\n            dataTransfer.effectAllowed = 'move'\n        }\n\n        /**\n         * Canvas init\n         */\n        function init () {\n            const { offsetWidth, offsetHeight } = container.value as HTMLElement\n            const defaultMaxWidth               = offsetWidth - props.padding\n            const defaultMaxHeight              = offsetHeight - props.padding\n            const ratioContainer                = offsetWidth / offsetHeight\n            const ratioCanvas                   = props.width / props.height\n\n            defaultScale.value = ratioContainer < ratioCanvas\n                ? defaultMaxWidth / props.width\n                : defaultMaxHeight / props.height\n            defaultX.value     = (offsetWidth - props.width) / 2\n            defaultY.value     = (offsetHeight - props.height) / 2\n            scale.value        = defaultScale.value\n            canvasX.value      = defaultX.value\n            canvasY.value      = defaultY.value\n        }\n\n        /**\n         * Create Resizable h Dom\n         * @param chartItem\n         */\n        function createResizableList (chartItem) {\n            const pointDirectionList          = ['a', 'b', 'c', 'd']\n            const resizablePointDirectionList = ['e', 'f', 'g', 'h']\n            const lineDirectionList           = ['i', 'j', 'k', 'l']\n            const resizableList               = []\n\n            pointDirectionList.forEach(direction => {\n                resizableList.push(h('div', {\n                    class      : [\n                        'resizable-point',\n                        direction,\n                    ],\n                    key        : direction,\n                    tabindex   : -1,\n                    draggable  : true,\n                    onDragstart: event => resizeStart(event, chartItem, direction),\n                }))\n            })\n\n            resizablePointDirectionList.forEach(direction => {\n                resizableList.push(h('div', {\n                    class: [\n                        'resizable-point',\n                        direction,\n                    ],\n                    key  : direction,\n                }))\n            })\n\n            lineDirectionList.forEach(direction => {\n                resizableList.push(h('div', {\n                    class      : [\n                        'resizable-line',\n                        direction,\n                    ],\n                    key        : direction,\n                    tabindex   : -1,\n                    draggable  : true,\n                    onDragstart: event => resizeStart(event, chartItem, direction),\n                }))\n            })\n\n            return resizableList\n        }\n\n        /**\n         * Create Chart h Dom\n         */\n        function createChartList () {\n            const chartList = []\n\n            props.data.forEach((item, index) => {\n\n                const defaultSlot = ctx.slots.chart({\n                    chart: item,\n                    index,\n                })\n                const customSlot  = ctx.slots[`chart-${item.id}`]\n                    ? ctx.slots[`chart-${item.id}`]({\n                        chart: item,\n                        index,\n                    })\n                    : null\n\n                chartList.push(h('div', {\n                    class      : [\n                        'chart-item',\n                        movingChart.value?.id === item.id ? 'moving' : '',\n                        resizingChart.value?.id === item.id ? 'resizing' : '',\n                    ],\n                    key        : item.id,\n                    style      : chartStyleComputed.value(item, index),\n                    ['data-id']: item.id,\n                    tabindex   : -1,\n                    draggable  : !props.lock,\n                    onMousedown: setChartPosition,\n                    onDragstart: event => chartDragstart(event, item),\n                    onDragend  : chartDragend,\n                }, [\n                    h('div', {\n                        class: ['content'],\n                    }, [\n                        defaultSlot,\n                        customSlot,\n                    ]),\n                    h('div', {\n                        class: ['resizable'],\n                    }, createResizableList(item)),\n                ]))\n            })\n\n            return chartList\n        }\n\n        onMounted(() => {\n            init()\n            window.addEventListener('resize', init)\n        })\n\n        onBeforeUnmount(() => {\n            window.removeEventListener('resize', init)\n        })\n\n        return () => [\n            h('div', {\n                class    : [\n                    'draggable-panel',\n                    props.lock ? 'lock' : '',\n                ],\n                tabindex : -1,\n                ref      : container,\n                autofocus: true,\n                onkeydown (event: KeyboardEvent) {\n                    const { ctrlKey, metaKey } = event\n                    const code                 = event.code.toLowerCase()\n\n                    // TODO: exact\n                    if (code === 'space') return canvasStatusMove.value = true\n                    if (code === 'equal' && (ctrlKey || metaKey)) return scaleAddByKeyboard(event)\n                    if (code === 'minus' && (ctrlKey || metaKey)) return scaleSubByKeyboard(event)\n                    if (code === 'digit0') {\n                        event.preventDefault()\n                        return resetScale()\n                    }\n                    if (code === 'enter') {\n                        event.preventDefault()\n                        return realScale()\n                    }\n                },\n                onkeyup (event: KeyboardEvent) {\n                    const code = event.code.toLowerCase()\n\n                    if (code === 'space') canvasStatusMove.value = false\n                },\n                onwheel   : scaleByWheel,\n                onDragover: dragoverContainer,\n            }, h('div', {\n                ref            : canvas,\n                class          : [\n                    'canvas',\n                    outCanvasDragover.value ? 'out-canvas-dragover' : '',\n                    canvasStatusMove.value ? 'moving' : '',\n                ],\n                style          : canvasStyleComputed.value,\n                onPointerdown  : pointerDown,\n                onPointermove  : pointermove,\n                onPointerup    : pointerUp,\n                onPointercancel: pointerCancel,\n                onDragenter    : dragenterCanvas,\n                onDragleave    : dragleaveCanvas,\n                onDrop         : dropInCanvas,\n            }, createChartList())),\n        ]\n    },\n}))\n"],"names":["markRaw","defineComponent","ref","computed","watch","h","onMounted","onBeforeUnmount"],"mappings":"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"}